{% extends 'base.html' %}

{% set tab = 'estimates' %}
{% set container_class = 'container-fluid' %}

{% block extra_js %}
    <script src="/static/app.js"></script>
{% endblock %}

{% block container %}

    <div id="abr">

        <div v-if="isLoading"><img src="static/loading.svg"></div>

        <div v-if="!isLoading">

            <div class="alert alert-danger" v-if="has_error()">
                <p v-if="error.auth">Your session has expired. <a href="/">Please log in again</a></p>
                <p v-if="error.unknown">An Unknown Error Occurred</p>
            </div>

            <div class="table-responsive">
                <table class="table table-hover table-border table-condensed">
                    <thead>
                    <th v-for="header in headers" :class="header">{$ header $}</th>
                    </thead>
                    <tbody>
                    <tr v-for="estimate in estimates" :class="estimate.class" v-on:click="show_estimate_notes(estimate)">
                        <td>{$ moment(estimate.TxnDate).format('MM/DD/YY') $}</td>
                        <td>{$ estimate.ExpirationDate ? moment(estimate.ExpirationDate).format('MM/DD/YY h:mma') : '' $}</td>
                        <td><a v-bind:href="customer_url(estimate)" target="qbo">{$ estimate.CustomerRef.name $}</a></td>
                        <td>{$ get_custom_field(estimate, 'Bike/Model') $}</td>
                        <td>{$ get_custom_field(estimate, 'Tag #') $}</td>
                        <td><a v-bind:href="estimate_url(estimate)" target="qbo">{$ estimate.DocNumber $}</a></td>
                        <td>${$ total_labor(estimate) $}</td>
                        <td>{$ get_notes(estimate) $}</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}

{% block head_js %}
{% endblock %}
