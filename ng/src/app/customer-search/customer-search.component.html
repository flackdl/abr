<ngx-loading [show]="isLoading"></ngx-loading>
<form>
  <div class="form-group">
    <label for="customer">Customer</label>
    <ng-select
      id="customer"
      (change)="customerSelected()"
      [ngModelOptions]="{standalone: true}"
      [(ngModel)]="customer"
      [items]="customers$ | async"
      [typeahead]="customerInput$"
      [loading]="customersLoading"
      [minTermLength]="2"
      bindLabel="FamilyName"
      autofocus
    >
    </ng-select>
  </div>
</form>

<div *ngIf="invoices" class="mt-3">
  <h5>Customer Invoices</h5>
  <table class="table table-bordered table-striped table-condensed">
    <thead>
    <tr>
      <th>Service Date</th>
      <th>Estimate Number</th>
      <th>Total Amount</th>
      <th>Notes</th>
      <th>Lines</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let invoice of invoices">
      <td>{{ invoice.TxnDate }}</td>
      <td>{{ invoice.DocNumber }}</td>
      <td>${{ invoice.TotalAmt }}</td>
      <td>{{ invoice.PrivateNote }}</td>
      <td>
        <div *ngFor="let line of invoice.Line">{{ line.Description }}</div>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<div class="d-flex justify-content-start mt-5 alert alert-info" *ngIf="needsNewCustomer">
  Can't find the customer?
  <button class="btn btn-primary ml-3" [routerLink]="['/wizard', 'customer', 'create']">Create a new one</button>
</div>

<div class="d-flex justify-content-end" *ngIf="customer">
  <button class="btn btn-success">Next</button>
</div>
